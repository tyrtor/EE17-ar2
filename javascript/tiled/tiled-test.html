<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="#">
    <title>Testar att visa Tiled karta i canvas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas></canvas>
    <script>
        /* element vi jobbar med */
        eCanvas = document.querySelector("canvas");

        /* storlek på canvas */
        eCanvas.width = 1280;
        eCanvas.height = 800;

        /* starta rityta */
        var ctx = eCanvas.getContext("2d");

        /* objekten */
        var spelplan = {
            höjd: 25,
            bredd: 40,
            rutor: 16,
            bild: new Image(),
            karta: [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 26, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 103, 104, 106, 0, 103, 106, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 0, 23, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 24, 24, 0, 0, 24, 24, 24, 24, 24, 24, 24, 10, 40, 40, 40, 40, 26, 25, 0, 23, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 24, 24, 0, 0, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 39, 41, 86, 39, 40, 40, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 58, 59, 24, 24, 0, 0, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 86, 0, 0, 67, 67, 67, 67, 67, 67, 67, 67, 119, 0, 0, 0, 1, 1, 1, 24, 25, 0, 23, 24, 24, 0, 0, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 102, 0, 0, 72, 72, 72, 72, 72, 72, 72, 181, 135, 1, 1, 1, 1, 1, 1, 24, 25, 0, 23, 24, 24, 0, 0, 24, 24, 24, 24, 24, 24, 24, 25, 149, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 133, 135, 0, 0, 0, 0, 0, 0, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 38, 9, 0, 0, 0, 0, 0, 0, 129, 130, 129, 130, 129, 130, 129, 130, 2, 133, 135, 0, 0, 0, 0, 0, 0, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 86, 145, 162, 161, 162, 161, 162, 161, 146, 2, 133, 135, 0, 0, 0, 0, 0, 0, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 7, 102, 9, 145, 162, 178, 177, 178, 177, 130, 2, 133, 166, 118, 118, 118, 118, 118, 118, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 38, 8, 8, 8, 8, 22, 24, 25, 129, 161, 162, 161, 162, 161, 146, 2, 149, 150, 150, 150, 150, 150, 150, 150, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 10, 40, 40, 40, 40, 26, 86, 25, 145, 162, 161, 162, 161, 162, 130, 2, 2, 2, 2, 129, 130, 129, 130, 129, 24, 25, 0, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 39, 102, 41, 129, 161, 162, 161, 162, 161, 162, 130, 129, 130, 2, 145, 162, 161, 162, 161, 24, 25, 0, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 41, 0, 0, 0, 0, 0, 0, 129, 161, 162, 161, 162, 161, 146, 145, 146, 47, 48, 2, 129, 161, 162, 161, 162, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 177, 178, 162, 161, 162, 130, 15, 1, 63, 64, 2, 145, 162, 161, 162, 161, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 161, 162, 161, 162, 161, 146, 31, 1, 83, 0, 0, 129, 161, 162, 161, 162, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 161, 162, 161, 162, 161, 162, 130, 0, 1, 0, 0, 0, 145, 177, 178, 177, 178, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 162, 161, 162, 161, 162, 161, 162, 130, 55, 55, 55, 55, 129, 161, 162, 161, 162, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 161, 162, 161, 162, 161, 162, 161, 146, 55, 55, 55, 55, 145, 162, 161, 162, 161, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 177, 178, 177, 178, 177, 178, 177, 130, 129, 130, 129, 130, 129, 161, 162, 161, 162],

        };

        /* ladda in tilesheet */
        spelplan.bild.src = "./forest_tiles.png";

        /* rita karta */
        function ritaKarta() {
            var index = 0;
            /* gå igenom varje rad */
            for (let rad = 0; rad < spelplan.höjd; rad++) {
                /* gå igenom varje kolumn */
                for (let kol = 0; kol < spelplan.bredd; kol++) {
                    /* rita inte ut om ruta är tom */
                    if (spelplan.karta[index] != 0) {
                        /* räkna ut pos i tilesheet */
                        var rutaX = Math.floor(spelplan.karta[index] % 16 - 1) * 32;
                        var rutaY = Math.floor(spelplan.karta[index] / 16) * 32;
                        /* rita ut rutan i canvas */
                        ctx.drawImage(spelplan.bild, rutaX, rutaY, 32, 32, kol * 32, rad * 32, 32, 32);
                    }

                    index++;
                }
            }
        }
        spelplan.bild.addEventListener("load", ritaKarta);
    </script>
</body>
</html>